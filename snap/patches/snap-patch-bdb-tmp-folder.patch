From 280c9f7177f5d18e68464b834577e223ad8abd9f Mon Sep 17 00:00:00 2001
From: cevap <dev@i2pmail.org>
Date: Mon, 4 Feb 2019 03:25:13 +0100
Subject: [PATCH] snap: patch bdb tmp folder

---
 depends/packages/bdb.mk | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/depends/packages/bdb.mk b/depends/packages/bdb.mk
index 6c9876c..3df7649 100644
--- a/depends/packages/bdb.mk
+++ b/depends/packages/bdb.mk
@@ -4,6 +4,7 @@ $(package)_download_path=http://download.oracle.com/berkeley-db
 $(package)_file_name=db-$($(package)_version).NC.tar.gz
 $(package)_sha256_hash=12edc0df75bf9abd7f82f821795bcee50f42cb2e5f76a6a281b85732798364ef
 $(package)_build_subdir=build_unix
+$(package)_patches=Change-tmp-folders-to-be-in-HOME-folder.patch
 
 define $(package)_set_vars
 $(package)_config_opts=--disable-shared --enable-cxx --disable-replication
@@ -13,6 +14,8 @@ $(package)_cxxflags=-std=c++11
 endef
 
 define $(package)_preprocess_cmds
+  chmod -R 777 .
+  patch -p1 < $($(package)_patch_dir)/Change-tmp-folders-to-be-in-HOME-folder.patch && \
   sed -i.old 's/__atomic_compare_exchange/__atomic_compare_exchange_db/' dbinc/atomic.h && \
   sed -i.old 's/atomic_init/atomic_init_db/' dbinc/atomic.h mp/mp_region.c mp/mp_mvcc.c mp/mp_fget.c mutex/mut_method.c mutex/mut_tas.c && \
   cp -f $(BASEDIR)/config.guess $(BASEDIR)/config.sub dist
-- 
2.17.1

